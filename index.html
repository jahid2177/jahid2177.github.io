<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Financial Calculator Suite</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* ================================================== */
        /* ============== 1. GLOBAL & APP SHELL ============= */
        /* ================================================== */
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-color: #f3f4f6;
            --text-dark: #1f2937;
            --card-radius: 20px;
            --shadow-sm: 0 4px 6px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: #eef2f5;
            color: var(--text-dark);
            min-height: 100vh;
        }

        .app-shell {
            max-width: 600px;
            margin: 0 auto;
            min-height: 100vh;
            background: #ffffff;
            box-shadow: 0 0 20px rgba(0,0,0,0.03);
            display: flex;
            flex-direction: column;
        }

        /* --- HEADER --- */
        header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .header-left { display: flex; align-items: center; gap: 12px; }

        #header-back-btn {
            background: #f3f4f6;
            border: none;
            color: #4b5563;
            width: 38px;
            height: 38px;
            border-radius: 12px;
            cursor: pointer;
            display: none;
            align-items: center; justify-content: center;
            font-size: 1rem;
            transition: all 0.2s;
        }
        #header-back-btn:active { transform: scale(0.95); background: #e5e7eb; }

        .logo {
            font-size: 1.3rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
        }

        main { padding: 20px; flex-grow: 1; overflow-y: auto; }

        .page { display: none; animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .page.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 25px;
            text-align: left;
            position: relative;
            padding-left: 15px;
        }
        .page-title::before {
            content: ''; position: absolute; left: 0; top: 5px; bottom: 5px;
            width: 4px; background: var(--primary-gradient); border-radius: 4px;
        }

        /* ================================================== */
        /* ============ PREMIUM GRID CARDS CSS ============== */
        /* ================================================== */
        .dashboard-grid, .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding-bottom: 20px;
        }
        @media (min-width: 480px) {
            .dashboard-grid, .options-grid { grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); }
        }

        .dashboard-card, .option-card, .circular-card {
            background: #ffffff;
            border-radius: var(--card-radius);
            padding: 20px 15px;
            text-align: center;
            text-decoration: none;
            cursor: pointer;
            box-shadow: var(--shadow-sm);
            border: 1px solid #f0f0f0;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            aspect-ratio: 1 / 1.1;
        }
        .dashboard-card:hover, .option-card:hover, .circular-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: var(--shadow-md);
        }

        .icon-box {
            width: 60px; height: 60px; border-radius: 18px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; margin-bottom: 15px; color: white;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1); transition: transform 0.3s;
        }
        .dashboard-card:hover .icon-box { transform: rotate(10deg) scale(1.1); }

        .c-1 .icon-box { background: linear-gradient(135deg, #FF9A9E, #FECFEF); }
        .c-2 .icon-box { background: linear-gradient(135deg, #a18cd1, #fbc2eb); }
        .c-3 .icon-box { background: linear-gradient(135deg, #84fab0, #8fd3f4); }
        .c-4 .icon-box { background: linear-gradient(135deg, #fccb90, #d57eeb); }
        .c-5 .icon-box { background: linear-gradient(135deg, #e0c3fc, #8ec5fc); }
        .c-6 .icon-box { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .c-7 .icon-box { background: linear-gradient(135deg, #4facfe, #00f2fe); }
        .c-8 .icon-box { background: linear-gradient(135deg, #43e97b, #38f9d7); }
        .c-9 .icon-box { background: linear-gradient(135deg, #fa709a, #fee140); }
        .c-10 .icon-box { background: linear-gradient(135deg, #667eea, #764ba2); }

        .card-title { font-size: 0.95rem; font-weight: 600; color: #374151; line-height: 1.4; }
        .option-card, .circular-card { background: #fff; color: var(--text-dark); }
        .option-card .icon-box, .circular-card .icon-box { background: #f3f4f6; color: #667eea; box-shadow: none; }

        /* --- CALCULATOR INPUTS --- */
        .calculator-container { background: white; padding: 25px; border-radius: 20px; box-shadow: var(--shadow-sm); border: 1px solid #f0f0f0; }
        .calc-input-group { margin-bottom: 20px; }
        .calc-input-group label { display: block; font-size: 0.9rem; color: #6b7280; margin-bottom: 8px; font-weight: 500; }
        .calc-input-group input, .calc-input-group select {
            width: 100%; padding: 14px; border-radius: 12px;
            border: 2px solid #f3f4f6; background: #f9fafb;
            font-size: 1rem; color: #1f2937; transition: 0.3s;
        }
        .calc-input-group input:focus, .calc-input-group select:focus {
            border-color: #a78bfa; background: white; outline: none;
            box-shadow: 0 0 0 4px rgba(167, 139, 250, 0.1);
        }
        .calc-btn {
            width: 100%; padding: 16px; border: none; border-radius: 14px;
            background: var(--primary-gradient); color: white;
            font-size: 1rem; font-weight: 600; cursor: pointer;
            box-shadow: 0 6px 20px rgba(118, 75, 162, 0.25); margin-top: 10px;
        }
        .calc-btn-secondary { background: #e5e7eb; color: #374151; box-shadow: none; }
        .calc-result {
            margin-top: 25px; padding: 20px; border-radius: 16px;
            background: #f5f3ff; border: 1px solid #ddd6fe; color: #5b21b6; display: none;
        }

        /* --- FOOTER --- */
        footer { padding: 25px; text-align: center; font-size: 0.8rem; color: #9ca3af; background: #f9fafb; margin-top: auto; }

        /* --- Main Calculator --- */
        #page-main-calculator .calculator { background: #1f2937; border-radius: 25px; padding: 20px; min-height: 400px; display: flex; flex-direction: column; }
        #page-main-calculator .display { background: #111827; border-radius: 15px; padding: 20px; margin-bottom: 20px; text-align: right; color: white; flex-grow: 1; }
        #page-main-calculator .history { color: #6b7280; font-size: 0.9rem; min-height: 1.2rem; }
        #page-main-calculator .result { font-size: 2.5rem; font-weight: 500; }
        #page-main-calculator .buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        #page-main-calculator button { aspect-ratio: 1; border-radius: 50%; border: none; font-size: 1.2rem; background: #374151; color: white; cursor: pointer; }
        #page-main-calculator .operator { background: #f59e0b; }
        #page-main-calculator .equals { background: #10b981; }
        #page-main-calculator .ac { background: #ef4444; }

        /* Fullscreen */
        body.calculator-fullscreen .app-shell { max-width: 100%; border-radius: 0; box-shadow: none; }
        body.calculator-fullscreen header, body.calculator-fullscreen footer { display: none; }
        body.calculator-fullscreen main { padding: 0; }
        body.calculator-fullscreen #page-main-calculator .calculator { height: 100vh; border-radius: 0; }
        .fullscreen-home-btn { 
            position: fixed; top: 20px; left: 20px; z-index: 2000;
            background: rgba(255,255,255,0.1); width: 45px; height: 45px; border-radius: 50%;
            display: none; align-items: center; justify-content: center; color: white; 
            backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.2);
        }
        body.calculator-fullscreen .fullscreen-home-btn { display: flex; }

        /* Modal */
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.6); z-index: 1000; backdrop-filter: blur(4px); }
        .modal-content { background: white; margin: 15% auto; padding: 25px; width: 90%; max-width: 400px; border-radius: 20px; animation: scaleIn 0.2s; }
        @keyframes scaleIn { from{transform:scale(0.9);opacity:0} to{transform:scale(1);opacity:1} }
        .close-btn { float: right; font-size: 1.5rem; cursor: pointer; color: #ef4444; }

    </style>
</head>
<body>
    <button class="fullscreen-home-btn" data-target="dashboard"><i class="fas fa-home"></i></button>
    
    <div class="app-shell">
        <header>
            <div class="header-left">
                <button id="header-back-btn"><i class="fas fa-chevron-left"></i></button>
                <div class="logo"><i class="fas fa-calculator" style="margin-right:8px;"></i>CalcSuite</div>
            </div>
        </header>

        <main id="content-area">

            <section class="page active" id="page-dashboard">
                <h2 class="page-title">Tools & Calculators</h2>
                <div class="dashboard-grid">
                    <div class="dashboard-card c-1" data-target="main-calculator"><div class="icon-box"><i class="fas fa-calculator"></i></div><div class="card-title">Standard<br>Calc</div></div>
                    <div class="dashboard-card c-2" data-target="age-calculator"><div class="icon-box"><i class="fas fa-birthday-cake"></i></div><div class="card-title">Age<br>Calc</div></div>
                    <div class="dashboard-card c-3" data-target="emi-calculator"><div class="icon-box"><i class="fas fa-chart-pie"></i></div><div class="card-title">EMI<br>Calc</div></div>
                    <div class="dashboard-card c-4" data-target="fdr-calculator"><div class="icon-box"><i class="fas fa-piggy-bank"></i></div><div class="card-title">FDR<br>Calc</div></div>
                    <div class="dashboard-card c-5" data-target="dps-calculator"><div class="icon-box"><i class="fas fa-wallet"></i></div><div class="card-title">DPS<br>Calc</div></div>
                    <div class="dashboard-card c-6" data-target="dbr-calculator"><div class="icon-box"><i class="fas fa-percentage"></i></div><div class="card-title">DBR<br>Calc</div></div>
                    <div class="dashboard-card c-7" data-target="elsl-calculator"><div class="icon-box"><i class="fas fa-user-tie"></i></div><div class="card-title">Employee<br>Loan</div></div>
                    <div class="dashboard-card c-8" data-target="credit-card"><div class="icon-box"><i class="fas fa-credit-card"></i></div><div class="card-title">Card<br>Info</div></div>
                    <div class="dashboard-card c-9" data-target="credit-card-circular"><div class="icon-box"><i class="fas fa-file-alt"></i></div><div class="card-title">Card<br>Circular</div></div>
                    <div class="dashboard-card c-10" data-target="notice"><div class="icon-box"><i class="fas fa-bell"></i></div><div class="card-title">Important<br>Notice</div></div>
               </div>
            </section>

            <section class="page" id="page-main-calculator">
                <div class="calculator">
                    <div class="display">
                        <div class="history" id="main-calc-history"></div>
                        <div class="result" id="main-calc-result">0</div>
                    </div>
                    <div class="buttons">
                        <button class="operator ac">AC</button><button class="operator parenthesis">( )</button><button class="operator percent">%</button><button class="operator divide">÷</button>
                        <button class="number">7</button><button class="number">8</button><button class="number">9</button><button class="operator multiply">×</button>
                        <button class="number">4</button><button class="number">5</button><button class="number">6</button><button class="operator subtract">−</button>
                        <button class="number">1</button><button class="number">2</button><button class="number">3</button><button class="operator add">+</button>
                        <button class="number">0</button><button class="number decimal">.</button><button class="operator backspace">⌫</button><button class="equals">=</button>
                    </div>
                </div>
            </section>

            <section class="page" id="page-age-calculator">
                <h2 class="page-title">Age Calculator</h2>
                <div class="calculator-container">
                    <div class="calc-input-group">
                        <label>Current Date</label>
                        <div style="display:grid; grid-template-columns:1fr 1.5fr 1fr; gap:8px;">
                            <select id="age-current-day"></select><select id="age-current-month"></select><select id="age-current-year"></select>
                        </div>
                    </div>
                    <div class="calc-input-group">
                        <label>Date of Birth</label>
                        <div style="display:grid; grid-template-columns:1fr 1.5fr 1fr; gap:8px;">
                            <select id="age-dob-day"></select><select id="age-dob-month"></select><select id="age-dob-year"></select>
                        </div>
                    </div>
                    <button class="calc-btn" id="age-calculate-btn">Calculate Age</button>
                    <div class="calc-result" id="age-result"></div>
                </div>
            </section>

            <section class="page" id="page-emi-calculator">
                <h2 class="page-title">EMI Calculator</h2>
                <div class="calculator-container">
                    <div class="calc-input-group"><label>Principal Amount</label><input type="number" id="emi-principal" placeholder="500000"></div>
                    <div class="calc-input-group"><label>Interest Rate (%)</label><input type="number" id="emi-rate" placeholder="9.0"></div>
                    <div class="calc-input-group"><label>Tenure</label><input type="number" id="emi-tenure" placeholder="Duration">
                        <div style="margin-top:8px; display:flex; gap:15px; font-size:0.9rem;">
                            <label><input type="radio" name="tenure_type" value="months" checked> Months</label>
                            <label><input type="radio" name="tenure_type" value="years"> Years</label>
                        </div>
                    </div>
                    <button id="emi-calculate-btn" class="calc-btn">Calculate EMI</button>
                    <button id="emi-amortization-btn" class="calc-btn calc-btn-secondary">View Schedule</button>
                    <div id="emi-result" class="calc-result"></div>
                </div>
            </section>
            
            <section class="page" id="page-fdr-calculator">
                 <h2 class="page-title">FDR Calculator</h2>
                 <div class="calculator-container">
                    <div class="calc-input-group"><label>Deposit Amount</label><input type="number" id="fdr-amount" placeholder="100000"></div>
                    <div class="calc-input-group"><label>Tenure</label><select id="fdr-months"><option value="1">1 Month (5%)</option><option value="3">3 Months (8.00%)</option><option value="3.10">3.10 Months (8.00%)</option><option value="6">6 Months (8.25%)</option><option value="12" selected>12 Months (8.50%)</option></select></div>
                    <div class="calc-input-group"><label>Tax Deduction</label><select id="fdr-tax-deduction"><option value="10">10%</option><option value="15">15%</option></select></div>
                    <button class="calc-btn" id="fdr-calculate-btn">Calculate Return</button>
                    <div id="fdr-result" class="calc-result"></div>
                 </div>
            </section>

            <section class="page" id="page-dps-calculator">
                 <h2 class="page-title">DPS Calculator</h2>
                 <div class="calculator-container">
                    <div class="calc-input-group"><label>Monthly Deposit</label><input type="number" id="dps-monthly-deposit" placeholder="5000"></div>
                    <div class="calc-input-group"><label>Tenure (Years)</label><select id="dps-tenure"><option value="3">3 Years (7.25%)</option><option value="5">5 Years (7.25%)</option><option value="7">7 Years (7.50%)</option><option value="10">10 Years (7.50%)</option></select></div>
                    <button class="calc-btn" id="dps-calculate-btn">Calculate Maturity</button>
                    <button id="dps-chart-btn" class="calc-btn calc-btn-secondary">View Chart</button>
                    <div id="dps-result" class="calc-result"></div>
                 </div>
            </section>
            
            <section class="page" id="page-dbr-calculator">
                <h2 class="page-title">DBR Calculator</h2>
                <div class="calculator-container">
                    <div class="calc-input-group"><label>Gross Monthly Income</label><input type="number" id="dbr-grossIncome" placeholder="50000"></div>
                    <div class="calc-input-group"><label>Existing Credit Card Limit</label><input type="number" id="dbr-creditCardLimit" placeholder="0"></div>
                    <div class="calc-input-group"><label>Proposed Credit Card Limit</label><input type="number" id="dbr-proposed-limit" placeholder="0"></div>
                    <div class="calc-input-group"><label>Existing Loan EMI</label><input type="number" id="dbr-existingEMI" placeholder="0"></div>
                    <div class="calc-input-group"><label>Proposed Loan EMI</label><input type="number" id="dbr-proposedEMI" placeholder="0"></div>
                    <button id="dbr-calculate-btn" class="calc-btn">Calculate DBR</button>
                    <div class="calc-result" id="dbr-result"></div>
                </div>
            </section>
            
            <section class="page" id="page-elsl-calculator">
                <h2 class="page-title">Employee Loan</h2>
                <div class="calculator-container">
                    <div class="calc-input-group"><label>Gross Salary</label><input type="number" id="elsl-grossSalary" placeholder="Enter Amount"></div>
                    <div class="calc-input-group"><label>Take Home Salary</label><input type="number" id="elsl-takeHomeSalary" placeholder="Enter Amount"></div>
                    <div class="calc-input-group"><label>Spouse's Take Home</label><input type="number" id="elsl-spouseSalary" placeholder="Enter Amount"></div>
                    <div class="calc-input-group"><label>Tenure</label><select id="elsl-tenure"><option value="3110">3 Years (৳3,110/lac)</option><option value="2410">4 Years (৳2,410/lac)</option><option value="1980">5 Years (৳1,980/lac)</option><option value="1680">6 Years (৳1,680/lac)</option><option value="1480">7 Years (৳1,480/lac)</option></select></div>
                    <button class="calc-btn" id="elsl-calculate-btn">Check Eligibility</button>
                    
                    <div style="margin-top:20px; font-size:0.9rem;">
                         <div style="display:flex; justify-content:space-between; margin-bottom:8px; border-bottom:1px solid #eee;"><span>Present Deduction:</span><span style="font-weight:600;" id="elsl-presentDeduction">-</span></div>
                         <div style="display:flex; justify-content:space-between; margin-bottom:8px; border-bottom:1px solid #eee;"><span>50% Gross:</span><span style="font-weight:600;" id="elsl-halfGross">-</span></div>
                         <div style="display:flex; justify-content:space-between; margin-bottom:8px; border-bottom:1px solid #eee;"><span>Max Installment:</span><span style="font-weight:600;" id="elsl-maxInstallment">-</span></div>
                         <div style="display:flex; justify-content:space-between; margin-bottom:8px; border-bottom:1px solid #eee;"><span>Installment per Lac:</span><span style="font-weight:600;" id="elsl-perLacInstallment">-</span></div>
                         <div style="display:flex; justify-content:space-between; margin-bottom:8px; color:var(--primary-gradient);"><span>Eligible Limit:</span><span style="font-weight:700;" id="elsl-eligibleLimit">-</span></div>
                         <div style="display:flex; justify-content:space-between; font-size:1.1em; background:#f0f9ff; padding:8px; border-radius:8px;"><span>Monthly Installment:</span><span style="font-weight:700; color:#0284c7;" id="elsl-totalMonthlyInstallment">-</span></div>
                    </div>
                </div>
            </section>
            
            <section class="page" id="page-credit-card">
                 <h2 class="page-title">Credit Card Services</h2>
                 <div class="options-grid">
                    <a href="consumer.jpg" target="_blank" class="option-card"><div class="icon-box"><i class="fas fa-user"></i></div><div class="card-title">Consumer<br>Charges</div></a>
                    <a href="corporate.jpg" target="_blank" class="option-card"><div class="icon-box"><i class="fas fa-building"></i></div><div class="card-title">Corporate<br>Charges</div></a>
                    <a href="emi.jpg" target="_blank" class="option-card"><div class="icon-box"><i class="fas fa-chart-line"></i></div><div class="card-title">Partner<br>EMI</div></a>
                    <a href="discount.jpg" target="_blank" class="option-card"><div class="icon-box"><i class="fas fa-percent"></i></div><div class="card-title">Partner<br>Discount</div></a>
                    <a href="Debit Card.jpg" target="_blank" class="option-card"><div class="icon-box"><i class="fas fa-credit-card"></i></div><div class="card-title">Debit Card<br>Charges</div></a>
                 </div>
            </section>

            <section class="page" id="page-credit-card-circular">
                <h2 class="page-title">Circulars</h2>
                <div class="options-grid">
                    <a href="senior citizen.jpg" target="_blank" class="circular-card"><div class="icon-box"><i class="fas fa-id-card"></i></div><div class="card-title">Senior<br>Citizen</div></a>
                    <a href="swadhin sanchay.jpg" target="_blank" class="circular-card"><div class="icon-box"><i class="fas fa-piggy-bank"></i></div><div class="card-title">Independent<br>Savings</div></a>
                    <a href="Revised Interest on Credit Card.jpg" target="_blank" class="circular-card"><div class="icon-box"><i class="fas fa-percent"></i></div><div class="card-title">Revised<br>Interest</div></a>
                    <a href="Annexure-01 (updated).jpg" target="_blank" class="circular-card"><div class="icon-box"><i class="fas fa-file-alt"></i></div><div class="card-title">Update<br>Annexure</div></a>
                </div>
            </section>

            <section class="page" id="page-notice">
                <h2 class="page-title">Notice</h2>
                <div class="calculator-container">
                    <div style="background:#fff7ed; color:#9a3412; padding:20px; border-radius:12px; border:1px solid #ffedd5;">
                        <h4 style="display:flex; align-items:center; gap:8px; margin-bottom:10px;"><i class="fas fa-sync-alt"></i> আপডেট পেতে:</h4>
                        <ul style="margin-left:25px; line-height:1.6;">
                            <li>অ্যাপ এর ডাটা ক্লিয়ার করুন।</li>
                            <li>আবার অ্যাপটি ওপেন করুন।</li>
                        </ul>
                    </div>
                </div>
            </section>

        </main>
        
        <footer>
            Built for PBL by Md. Jahidul Islam, Mirerdanga Branch.
        </footer>
    </div>

    <div id="amortization-modal" class="modal">
        <div class="modal-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h3 style="margin:0;">Amortization</h3>
                <span class="close-btn modal-close-btn">&times;</span>
            </div>
            <div style="max-height: 300px; overflow-y: auto; border:1px solid #eee; border-radius:8px;">
                <table style="width:100%; border-collapse:collapse; font-size:0.85rem;">
                    <thead style="position:sticky; top:0; background:#f9fafb; color:#4b5563;">
                        <tr><th style="padding:10px; text-align:center;">#</th><th style="text-align:right;">Int.</th><th style="text-align:right;">Prin.</th><th style="text-align:right; padding-right:10px;">Bal.</th></tr>
                    </thead>
                    <tbody id="amortization-table-body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 1. NAVIGATION & BACK BUTTON LOGIC ---
        const contentArea = document.getElementById('content-area');
        const pages = contentArea.querySelectorAll('.page');
        const navLinks = document.querySelectorAll('[data-target]');
        const headerBackBtn = document.getElementById('header-back-btn');

        function navigateTo(pageId) {
            pages.forEach(page => page.classList.remove('active'));
            const targetPage = document.getElementById(`page-${pageId}`);
            if (targetPage) targetPage.classList.add('active');
            window.scrollTo(0, 0);

            if (pageId === 'dashboard' || pageId === 'main-calculator') {
                headerBackBtn.style.display = 'none';
            } else {
                headerBackBtn.style.display = 'flex';
            }

            const body = document.body;
            if (pageId === 'main-calculator') body.classList.add('calculator-fullscreen');
            else body.classList.remove('calculator-fullscreen');
        }

        navLinks.forEach(link => link.addEventListener('click', (e) => {
            const target = e.currentTarget.getAttribute('data-target');
            if(target) navigateTo(target);
        }));
        
        headerBackBtn.addEventListener('click', () => navigateTo('dashboard'));
        document.querySelector('.fullscreen-home-btn').addEventListener('click', () => navigateTo('dashboard'));
        document.querySelector('.logo').addEventListener('click', () => navigateTo('dashboard'));

        // --- 2. CALCULATOR LOGIC ---
        const fmt = (n) => n.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
        const getVal = (id) => parseFloat(document.getElementById(id).value) || 0;

        // Main Calc
        let currentInput = '0';
        const hDisp = document.getElementById('main-calc-history'), rDisp = document.getElementById('main-calc-result');
        document.querySelector('#page-main-calculator .buttons').addEventListener('click', (e) => {
            if(!e.target.matches('button')) return;
            const val = e.target.innerText, cls = e.target.classList;
            if(cls.contains('number')) currentInput = (currentInput === '0' && val !== '.') ? val : currentInput + val;
            else if(cls.contains('ac')) { currentInput = '0'; hDisp.innerText = ''; }
            else if(cls.contains('backspace')) currentInput = currentInput.slice(0,-1) || '0';
            else if(cls.contains('equals')) { try{ currentInput = String(eval(currentInput.replace(/×/g,'*').replace(/÷/g,'/').replace(/−/g,'-'))); }catch{currentInput='Error';} }
            else if(val!=='( )' && val!='%') currentInput += val; 
            rDisp.innerText = currentInput;
        });

        // Age Calc
        const pop = (id, s, e, m=false) => { const el = document.getElementById(id); const n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]; for(let i=s; m?i<12:i<=e; i++) el.add(new Option(m?n[i]:i,i)); };
        const d = new Date(); pop('age-current-day',1,31); pop('age-current-month',0,11,true); pop('age-current-year',1900,2050);
        pop('age-dob-day',1,31); pop('age-dob-month',0,11,true); pop('age-dob-year',1900,2050);
        document.getElementById('age-current-day').value = d.getDate(); document.getElementById('age-current-month').value = d.getMonth(); document.getElementById('age-current-year').value = d.getFullYear();
        document.getElementById('age-calculate-btn').addEventListener('click', () => {
             const v = (i) => parseInt(document.getElementById(i).value);
             const diff = new Date(v('age-current-year'),v('age-current-month'),v('age-current-day')) - new Date(v('age-dob-year'),v('age-dob-month'),v('age-dob-day'));
             if(diff<0) return;
             const a = new Date(diff); 
             document.getElementById('age-result').innerHTML = `Age: <strong>${Math.abs(a.getUTCFullYear()-1970)}</strong> Years, <strong>${a.getUTCMonth()}</strong> Months, <strong>${a.getUTCDate()-1}</strong> Days`;
             document.getElementById('age-result').style.display='block';
        });

        // EMI
        document.getElementById('emi-calculate-btn').addEventListener('click', () => {
            const P = getVal('emi-principal'), R = getVal('emi-rate')/1200, N = getVal('emi-tenure') * (document.querySelector('input[name="tenure_type"]:checked').value === 'years' ? 12 : 1);
            if(P<=0) return;
            const emi = (P * R * Math.pow(1+R,N)) / (Math.pow(1+R,N)-1);
            document.getElementById('emi-result').innerHTML = `EMI: <strong>${fmt(emi)}</strong><br>Total Pay: <strong>${fmt(emi*N)}</strong>`;
            document.getElementById('emi-result').style.display='block';
        });
        const modal = document.getElementById('amortization-modal');
        document.getElementById('emi-amortization-btn').addEventListener('click', () => { modal.style.display = 'block'; });
        document.querySelector('.modal-close-btn').addEventListener('click', () => { modal.style.display = 'none'; });
        window.onclick = (e) => { if(e.target == modal) modal.style.display = 'none'; };

        // FDR
        document.getElementById('fdr-calculate-btn').addEventListener('click', () => {
            const interest = getVal('fdr-amount') * ({'1':0.05,'3':0.08,'3.10':0.08,'6':0.0825,'12':0.0850}[document.getElementById('fdr-months').value]) * (parseFloat(document.getElementById('fdr-months').value)/12);
            document.getElementById('fdr-result').innerHTML = `Net Interest: <strong>${fmt(interest * (1 - getVal('fdr-tax-deduction')/100))}</strong>`;
            document.getElementById('fdr-result').style.display='block';
        });

        // DPS
        document.getElementById('dps-calculate-btn').addEventListener('click', () => {
            const r = (getVal('dps-tenure')<=5 ? 7.25 : 7.50)/1200, n = getVal('dps-tenure')*12;
            document.getElementById('dps-result').innerHTML = `Maturity: <strong>${fmt(getVal('dps-monthly-deposit') * ((Math.pow(1+r,n)-1)/r))}</strong>`;
            document.getElementById('dps-result').style.display='block';
        });

        // DBR
        document.getElementById('dbr-calculate-btn').addEventListener('click', () => {
            const obl = getVal('dbr-existingEMI') + getVal('dbr-proposedEMI') + ((getVal('dbr-creditCardLimit') + getVal('dbr-proposed-limit')) * 0.05);
            document.getElementById('dbr-result').innerHTML = `DBR: <strong>${fmt((obl/getVal('dbr-grossIncome'))*100)}%</strong>`;
            document.getElementById('dbr-result').style.display='block';
        });
        
        // ================================================== //
        // ============ 8. ELSL CALCULATOR LOGIC ============ //
        // ================================================== //
        (() => {
            document.getElementById('elsl-calculate-btn').addEventListener('click', () => {
                const gross = parseFloat(document.getElementById('elsl-grossSalary').value) || 0;
                const takeHome = parseFloat(document.getElementById('elsl-takeHomeSalary').value) || 0;
                const spouse = parseFloat(document.getElementById('elsl-spouseSalary').value) || 0;
                const perLac = parseFloat(document.getElementById('elsl-tenure').value);
                if (gross <= 0) { alert("Valid gross salary required."); return; }

                const totalGross = gross + spouse, totalTakeHome = takeHome + spouse;
                const deduction = totalGross - totalTakeHome, halfGross = totalGross * 0.5;
                const maxInstall = halfGross - deduction;
                if (maxInstall <= 0) { alert("Not eligible based on current deductions."); return; }

                let eligible = Math.min(Math.floor((maxInstall / perLac * 100000) / 1000) * 1000, 1000000);
                const monthlyInstall = (eligible / 100000) * perLac;
                
                const format = (num) => '৳' + num.toLocaleString('en-IN', {minimumFractionDigits: 2, maximumFractionDigits: 2});
                document.getElementById('elsl-presentDeduction').textContent = format(deduction);
                document.getElementById('elsl-halfGross').textContent = format(halfGross);
                document.getElementById('elsl-maxInstallment').textContent = format(maxInstall > 0 ? maxInstall : 0);
                document.getElementById('elsl-perLacInstallment').textContent = format(perLac);
                document.getElementById('elsl-eligibleLimit').textContent = format(eligible > 0 ? eligible : 0);
                document.getElementById('elsl-totalMonthlyInstallment').textContent = format(monthlyInstall > 0 ? monthlyInstall : 0);
            });
        })();

    });
    </script>
</body>
</html>
